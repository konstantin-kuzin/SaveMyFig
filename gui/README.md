# Figma Export GUI

Графический интерфейс для инструмента экспорта файлов Figma.

## Описание

Это приложение предоставляет удобный графический интерфейс для работы с инструментом экспорта файлов Figma. Оно позволяет легко настраивать параметры, запускать процессы бэкапа и просматривать статистику.

## Требования

- macOS 11+ (Big Sur и новее)
- Node.js 20 LTS (будет установлен автоматически при первом запуске)
- Доступ к интернету для установки зависимостей

## Установка

1. Скачайте репозиторий
2. Запустите `start-gui.command` двойным кликом
3. При первом запуске приложение автоматически установит все необходимые зависимости

## Использование

### Первый запуск

1. При первом запуске приложение проверит наличие Node.js
2. Если Node.js не найден, будет предложено установить его
3. После установки Node.js приложение автоматически установит все зависимости

### Настройка

1. Перейдите на вкладку "Настройки"
2. Введите ваш Figma Access Token
3. Добавьте аккаунты Figma (Email/Password или Cookie)
4. Укажите путь для загрузки файлов
5. Настройте дополнительные параметры (таймауты, лимиты)
6. Сохраните конфигурацию

> Все чувствительные данные (`.env`, `figma_backups.db`, `files.json`, Playwright отчёты) хранятся в каталоге `.userData/` в корне проекта. Приложение создаёт эту папку автоматически и не добавляет её в git.

### Запуск бэкапа

1. Перейдите на вкладку "Скачивание"
2. Выберите нужную команду:
   - `npm run start` - основной запуск
   - `npm run retry` - повтор неудачных
   - `npm run dry-run` - предпросмотр
   - `npm run run-backup` - полный цикл
3. Нажмите кнопку "Start"
4. Следите за прогрессом в реальном времени

### Просмотр статистики

1. Перейдите на вкладку "Статистика"
2. Просматривайте общую статистику бэкапов
3. Используйте таблицу для детального просмотра
4. Фильтруйте данные по необходимости

### Диагностика

1. Перейдите на вкладку "Диагностика"
2. Просматривайте информацию о системе
3. Проверяйте статус зависимостей
4. Просматривайте логи приложения

## Структура проекта

```
gui/
├── package.json              # Зависимости GUI
├── main.ts                   # Main process (Electron)
├── preload.ts                # Preload script (IPC bridge)
├── renderer/                 # Renderer process
│   ├── index.html           # UI markup
│   ├── styles.css           # Стили
│   ├── renderer.ts          # UI логика на TypeScript
│   └── components/           # UI компоненты
│       ├── welcome.ts       # Экран установки
│       ├── config.ts        # Экран конфигурации
│       ├── backup.ts        # Экран выполнения бэкапа
│       ├── statistics.ts    # Экран статистики
│       └── settings.ts       # Экран настроек
└── utils/                   # Утилиты
    ├── node-checker.ts      # Проверка Node.js
    ├── installer.ts         # Установка зависимостей
    ├── env-manager.ts       # Управление `.userData/.env`
    ├── db-reader.ts        # Чтение SQLite
    ├── script-runner.ts     # Запуск npm скриптов (execa)
    ├── validator.ts         # Валидация ввода
    └── logger.ts            # Логирование и диагностика
```

## Разработка

### Сборка проекта

```bash
# Установка зависимостей
npm install

# Компиляция TypeScript
npm run build

# Запуск в режиме разработки
npm run dev

# Создание дистрибутива
npm run dist
```

### Архитектура

Приложение построено на архитектуре Electron с разделением на три основных части:

1. **Main Process** - управляет жизненным циклом приложения, системными операциями и IPC handlers
2. **Preload Script** - безопасный мост между Main и Renderer процессами
3. **Renderer Process** - пользовательский интерфейс, построенный на HTML/CSS/TypeScript

### Безопасность

- Используется `contextIsolation` для изоляции контекстов
- `nodeIntegration` отключен
- Все системные операции выполняются в Main Process
- Данные передаются через безопасный IPC мост

## Решение проблем

### Проблемы с запуском

Если приложение не запускается:

1. Убедитесь, что у вас установлен Node.js 20+
2. Попробуйте удалить `node_modules` и переустановить зависимости:
   ```bash
   rm -rf node_modules
   npm install
   ```
3. Проверьте права доступа к папке приложения

### Проблемы с зависимостями

Если возникают ошибки при установке зависимостей:

1. Убедитесь, что у вас есть доступ к интернету
2. Проверьте права доступа к папке `node_modules`
3. Попробуйте установить зависимости вручную:
   ```bash
   npm install
   npx playwright install
   ```

## Лицензия

MIT

## Автор

Konstantin Kuzin
