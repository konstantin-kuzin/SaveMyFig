<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Figma Export GUI</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app">
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="sidebar">
      <div class="nav-menu">
        <div><a href="#" data-tab="welcome" class="nav-link active">–£—Å—Ç–∞–Ω–æ–≤–∫–∞</a></div>
        <div><a href="#" data-tab="config" class="nav-link">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></div>
        <div><a href="#" data-tab="backup" class="nav-link">–°–∫–∞—á–∏–≤–∞–Ω–∏–µ</a></div>
        <div><a href="#" data-tab="statistics" class="nav-link">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></div>
        <div><a href="#" data-tab="settings" class="nav-link">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</a></div>
      </div>
    </nav>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
      <!-- –≠–∫—Ä–∞–Ω —É—Å—Ç–∞–Ω–æ–≤–∫–∏ -->
      <div id="welcome-tab" class="tab-content active">
        <div class="tab-header">
          <h2>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</h2>
          <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</p>
        </div>
        <div class="tab-body">
          <div id="system-check" class="check-section">
            <h3>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
            <div id="node-status" class="status-item">
              <span class="status-label">Node.js:</span>
              <span class="status-value">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
            </div>
            <div id="npm-status" class="status-item">
              <span class="status-label">npm:</span>
              <span class="status-value">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
            </div>
          
          </div><br/>

          <div id="installation-section" class="install-section">
            <h3>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h3><br/>
            <button id="install-btn" class="btn btn-primary" disabled>
              –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
            </button>
            <div id="install-progress" class="progress-container hidden">
              <div class="progress-bar">
                <div class="progress-fill"></div>
              </div>
              <div class="progress-text">–£—Å—Ç–∞–Ω–æ–≤–∫–∞...</div>
            </div>
            <div id="install-log" class="log-container hidden">
              <div class="log-content"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ -->
      <div id="config-tab" class="tab-content">
        <div class="tab-header">
          <h2>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</h2>
          <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Figma –∏ –ø—É—Ç–µ–π –∑–∞–≥—Ä—É–∑–∫–∏</p>
        </div>
        <div class="tab-body">
          <form id="config-form">
            <!-- Figma Access Token -->
            <div class="form-section">
              <h3>Figma Access Token</h3>
              <div class="form-group">
                <label for="figma-token">–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞:</label>
                <div class="input-group">
                  <input type="password" id="figma-token" name="FIGMA_ACCESS_TOKEN" 
                         placeholder="figd_..." required>
                  <button type="button" id="toggle-token" class="btn btn-secondary">üëÅÔ∏è</button>
                </div>
                <small class="form-help">
                  <a href="https://www.figma.com/developers/api#authentication" target="_blank">
                    –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
                  </a>
                </small>
              </div>
            </div>

            <!-- Figma Accounts -->
            <div class="form-section">
              <h3>–ê–∫–∫–∞—É–Ω—Ç—ã Figma</h3>
              <div id="accounts-container">
                <!-- –ê–∫–∫–∞—É–Ω—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
              </div>
              <button type="button" id="add-account" class="btn btn-secondary">
                + –î–æ–±–∞–≤–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç
              </button>
            </div>

            <!-- –ü—É—Ç–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã -->
            <div class="form-section">
              <h3>–ü—É—Ç–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h3>
              <div class="form-group">
                <label for="download-path">–ü–∞–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:</label>
                <div class="input-group">
                  <input type="text" id="download-path" name="DOWNLOAD_PATH" 
                         placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É" readonly required>
                  <button type="button" id="select-path" class="btn btn-secondary">üìÅ</button>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="wait-timeout">–¢–∞–π–º–∞—É—Ç (–º—Å):</label>
                  <input type="number" id="wait-timeout" name="WAIT_TIMEOUT"
                        value="10000" min="5000" max="600" required>
                </div>

                <div class="form-group">
                  <label for="max-files">–ú–∞–∫—Å–∏–º—É–º —Ñ–∞–π–ª–æ–≤:</label>
                  <input type="number" id="max-files" name="MAX_FILES"
                        value="45" min="1" max="200" required>
                </div>
              </div>

              <div class="form-group">
                <label for="retry-delay">–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ–≤—Ç–æ—Ä–∞ (—á–∞—Å—ã):</label>
                <input type="number" id="retry-delay" name="RETRY_DELAY_HOURS"
                       value="72" min="1" max="720" required>
              </div>
            </div>
            <!-- Team/Project IDs -->
            <div class="form-section">
              <h3>–í—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤</h3>
              <div class="form-group">
                <div class="radio-group">
                  <label>
                    <input type="radio" name="select-type" value="team" checked>
                    –ü–æ Team IDs
                  </label>
                  <label>
                    <input type="radio" name="select-type" value="project">
                    –ü–æ Project IDs
                  </label>
                </div>
              </div>
              
              <div class="form-group">
                <label for="team-ids" class="team-label">Team IDs:</label>
                <label for="project-ids" class="project-label hidden">Project IDs:</label>
                <textarea id="team-ids" name="TEAM_IDS" class="team-input" 
                          placeholder="team1,team2,team3" rows="3"></textarea>
                <textarea id="project-ids" name="PROJECT_IDS" class="project-input hidden" 
                          placeholder="project1,project2,project3" rows="3"></textarea>
                <small class="form-help">–ú–∞–∫—Å–∏–º—É–º 50 ID, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—è—Ç–æ–π</small>
              </div>
              
              <button type="button" id="generate-files" class="btn btn-secondary">
                üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å files.json
              </button>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="form-actions">
              <button type="button" id="load-config" class="btn btn-secondary">
                üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ .env
              </button>
              <button type="submit" class="btn btn-primary">
                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—ç–∫–∞–ø–∞ -->
      <div id="backup-tab" class="tab-content">
        <div class="tab-header">
          <h2>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞</h2>
          <p>–ó–∞–ø—É—Å–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤</p>
        </div>
        <div class="tab-body">
          <div class="backup-controls">
            <div class="form-group">
              <label for="script-command">–ö–æ–º–∞–Ω–¥–∞:</label>
              <select id="script-command" class="form-control">
                <option value="run-backup" selected>npm run run-backup - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª</option>
                <option value="start">npm run start - –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–ø—É—Å–∫</option>
                <option value="retry">npm run retry - –ø–æ–≤—Ç–æ—Ä –Ω–µ—É–¥–∞—á–Ω—ã—Ö</option>
                <option value="dry-run">npm run dry-run - –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</option>
              </select>
            </div>

            <div class="backup-buttons">
              <button id="start-backup" class="btn btn-success">‚ñ∂Ô∏è Start</button>
              <button id="stop-backup" class="btn btn-danger" disabled>‚èπÔ∏è Stop</button>
              <button id="clear-log" class="btn btn-secondary">üóëÔ∏è Clear Log</button>
            </div>
          </div>

          <div class="backup-status">
            <div class="status-indicator">
              <span class="status-dot idle"></span>
              <span class="status-text">Idle</span>
            </div>
            <div class="progress-info">
              <span id="progress-text">–ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É</span>
            </div>
          </div>
          
          <div class="log-container">
            <div id="backup-log" class="log-content"></div>
          </div>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
      <div id="statistics-tab" class="tab-content">
        <div class="tab-header">
          <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
          <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±—ç–∫–∞–ø–∞—Ö –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</p>
        </div>
        <div class="tab-body">
          <div class="stats-cards">
            <div class="form-section">
              <div class="stat-info">
                <div class="stat-value" id="total-files">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤</div>
              </div>
            </div>

            <div class="form-section">
              <div class="stat-info">
                <div class="stat-value" id="needing-backup">0</div>
                <div class="stat-label">–¢—Ä–µ–±—É—é—Ç –±—ç–∫–∞–ø–∞</div>
              </div>
            </div>

            <div class="form-section">
              <div class="stat-info">
                <div class="stat-value" id="with-errors">0</div>
                <div class="stat-label">–° –æ—à–∏–±–∫–∞–º–∏</div>
              </div>
            </div>
          </div>
          
          <div class="table-container">
            <table id="backups-table">
              <thead>
                <tr>
                  <th data-sort="file_key">–ö–ª—é—á —Ñ–∞–π–ª–∞</th>
                  <th data-sort="project_name">–ü—Ä–æ–µ–∫—Ç</th>
                  <th data-sort="file_name">–ò–º—è —Ñ–∞–π–ª–∞</th>
                  <th data-sort="last_backup_date">–ü–æ—Å–ª–µ–¥–Ω–∏–π –±—ç–∫–∞–ø</th>
                  <th data-sort="last_modified_date">–ò–∑–º–µ–Ω–µ–Ω –≤ Figma</th>
                  <th data-sort="next_attempt_date">–°–ª–µ–¥—É—é—â–∞—è –ø–æ–ø—ã—Ç–∫–∞</th>
                </tr>
              </thead>
              <tbody id="backups-tbody">
                <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- –≠–∫—Ä–∞–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ -->
      <div id="settings-tab" class="tab-content">
        <div class="tab-header">
          <h2>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
          <p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
        </div>
        <div class="tab-body">
          <div class="diagnostic-section">
            <h3>–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="info-grid">
              <div class="info-item">
                <label>Node.js –≤–µ—Ä—Å–∏—è:</label>
                <span id="node-version">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
              </div>
              <div class="info-item">
                <label>Node.js –ø—É—Ç—å:</label>
                <span id="node-path">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
              </div>
              <div class="info-item">
                <label>npm –≤–µ—Ä—Å–∏—è:</label>
                <span id="npm-version">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
              </div>
              <div class="info-item">
                <label>npm –ø—É—Ç—å:</label>
                <span id="npm-path">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
              </div>
              <div class="info-item">
                <label>–í–µ—Ä—Å–∏—è GUI:</label>
                <span id="gui-version">1.0.0</span>
              </div>
              <div class="info-item">
                <label>–í–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞:</label>
                <span id="script-version">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
              </div>
            </div>
          </div>
          
          <div class="diagnostic-section">
            <h3>–°—Ç–∞—Ç—É—Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</h3>
            <div id="deps-status" class="status-list">
              <!-- –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>

          <div class="diagnostic-section">
            <h3>–î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ</h3>
            <div id="fs-status" class="status-list">
              <!-- –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>
          
          <div class="diagnostic-section">
            <h3>–î–æ—Å—Ç—É–ø –∫ Figma API</h3>
            <div id="api-status" class="status-list">
              <!-- –°—Ç–∞—Ç—É—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>
          
          <div class="diagnostic-section">
            <h3>–õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h3>
            <div class="log-controls">
              <button id="refresh-logs" class="btn btn-secondary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
              <button id="clear-logs" class="btn btn-warning">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
              <button id="open-logs-folder" class="btn btn-secondary">üìÅ –û—Ç–∫—Ä—ã—Ç—å –ø–∞–ø–∫—É</button>
            </div>
            <div class="log-container">
              <div id="diagnostic-log" class="log-content"></div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="module" src="./ui.js"></script>
</body>
</html>